<!-- Filter Section -->
<div class="bg-gray-100 p-4 mb-6 rounded-lg shadow-sm">
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-4 items-end">
    <!-- Location Select -->
    <div class="flex flex-col">
      <p-select [options]="cities" [(ngModel)]="selectedCity" placeholder="Select a Location" class="w-full"
        styleClass="w-full" />
    </div>

    <!-- Category Select -->
    <div class="flex flex-col">
      <p-select [options]="categories" [(ngModel)]="selectedCategory" optionValue="id" optionLabel="categoryName"
        placeholder="Select a Category" class="w-full" styleClass="w-full" />
    </div>

    <!-- Tags MultiSelect -->
    <div class="flex flex-col">
      <p-multiselect [options]="tags" [(ngModel)]="selectedTags" optionLabel="name" optionValue="id"
        placeholder="Select Tags" [maxSelectedLabels]="3" class="w-full" styleClass="w-full" />
    </div>

    <!-- Price Input -->
    <div class="flex flex-col">
      <label class="text-sm font-medium text-gray-700 mb-1" for="price">Price</label>
      <p-inputnumber [(ngModel)]="SelectedPrice" inputId="price" mode="decimal" [min]="1" class="w-full"
        styleClass="w-full" />
    </div>

    <!-- Min Quantity Input -->
    <div class="flex flex-col">
      <label class="text-sm font-medium text-gray-700 mb-1" for="minQty">Min Quantity</label>
      <p-inputnumber [(ngModel)]="SelectedMinQty" inputId="minQty" mode="decimal" [min]="1" class="w-full"
        styleClass="w-full" />
    </div>

    <!-- Action Buttons -->
    <div class="flex gap-2">
      <p-button label="Apply" [raised]="true" severity="success" (onClick)="setFilters()" class="flex-1 h-12 px-6"
        styleClass="flex-1 h-12 px-6" />
      <p-button label="Clear" [raised]="true" severity="danger" (onClick)="resetFilters()" class="flex-1 h-12 px-6"
        styleClass="flex-1 h-12 px-6" />
    </div>
  </div>
</div>

<!-- Loading Skeleton -->
@if (isLoading) {
<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 px-4">
  @for (item of [1,2,3,4,5,6,7,8]; track $index) {
  <div class="bg-white rounded-lg shadow-md overflow-hidden animate-pulse">
    <!-- Image skeleton -->
    <div class="w-full h-48 bg-gray-200"></div>

    <!-- Content skeleton -->
    <div class="p-4">
      <!-- Title skeleton -->
      <div class="h-6 bg-gray-200 rounded mb-2"></div>

      <!-- Price skeleton -->
      <div class="h-8 bg-gray-200 rounded mb-3 w-1/2"></div>

      <!-- Description skeleton -->
      <div class="space-y-2">
        <div class="h-4 bg-gray-200 rounded"></div>
        <div class="h-4 bg-gray-200 rounded w-3/4"></div>
        <div class="h-4 bg-gray-200 rounded w-1/2"></div>
      </div>

      <!-- Button skeleton -->
      <div class="mt-4 h-10 bg-gray-200 rounded"></div>
    </div>
  </div>
  }
</div>
}

<!-- No Products Found Message -->
@if (!isLoading && (!products || products.length === 0)) {
<div class="flex flex-col items-center justify-center py-16 px-4">
  <div class="text-center">
    <div class="mb-4">
      <svg class="mx-auto h-16 w-16 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
      </svg>
    </div>
    <h3 class="text-lg font-medium text-gray-900 mb-2">No Products Found</h3>
    <p class="text-gray-500 mb-6">Try adjusting your filters or search criteria to find what you're looking for.</p>
    <p-button label="Clear Filters" severity="secondary" (onClick)="resetFilters()" />
  </div>
</div>
}

<!-- Products Grid -->
@if (!isLoading && products && products.length > 0) {
<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 px-4">
  @for (product of products; track $index) {
  <p-card class="h-full flex flex-col hover:transform hover:-translate-y-1 hover:shadow-lg transition-all duration-200"
    [style]="{ overflow: 'hidden' }">
    <ng-template #header>
      <a [routerLink]="['/ProductDetails', product.id]" class="block">
        <img alt="Card"
          class="w-full h-48 object-cover cursor-pointer hover:scale-105 transition-transform duration-200"
          [src]="product.images[0]" />
      </a>
    </ng-template>

    <ng-template #title>
      <h3 class="text-lg font-semibold text-gray-800 truncate">{{product.name}}</h3>
    </ng-template>

    <ng-template #subtitle>
      <p class="text-xl font-bold text-green-600">{{product.price| currency}}</p>
    </ng-template>

    <p class="text-gray-600 text-sm flex-grow overflow-hidden"
      [style]="{'display': '-webkit-box', '-webkit-line-clamp': '3', '-webkit-box-orient': 'vertical'}">
      {{product.description}}</p>

    <ng-template #footer>
      <div class="w-full">
        <p-button label="Order Now" class="w-full" styleClass="w-full" />
      </div>
    </ng-template>
  </p-card>
  }
</div>
}

<!-- Pagination -->
@if (!isLoading && products && products.length > 0) {
<div class="flex justify-center mt-8 px-4">
  <p-paginator (onPageChange)="onPageChange($event)" [first]="first" [rows]="8" [totalRecords]="totalRecords"
    class="w-full max-w-md" />
</div>
}
