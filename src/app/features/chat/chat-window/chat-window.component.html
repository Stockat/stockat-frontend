<div class="flex flex-col h-full bg-white rounded-xl shadow p-4">
  <div class="flex-1 overflow-y-auto mb-4">
    <div *ngFor="let msg of messages" class="mb-2 flex items-end gap-2" [ngClass]="{'justify-end': false, 'justify-start': true}">
      <!-- Avatar -->
      <p-avatar *ngIf="msg.sender?.profileImageUrl" [image]="msg.sender.profileImageUrl" shape="circle" size="large" class="mr-2"></p-avatar>
      <div class="max-w-xs md:max-w-md p-3 rounded-lg shadow text-sm bg-gray-100 text-gray-800">
        <div class="flex items-center gap-2 mb-1">
          <span class="font-semibold text-xs">{{ msg.sender?.fullName }}</span>
          <span class="text-xs text-gray-400">{{ msg.sentAt ? (msg.sentAt | date:'shortTime') : '' }}</span>
        </div>
        <div *ngIf="msg.messageText">{{ msg.messageText || '' }}</div>
        <img *ngIf="msg.imageUrl" [src]="msg.imageUrl || ''" class="rounded-lg max-h-40 my-2" />
        <audio *ngIf="msg.voiceUrl" [src]="msg.voiceUrl || ''" controls class="my-2"></audio>
        <div class="flex gap-2 mt-2 items-center">
          <ng-container *ngFor="let reaction of msg.reactions">
            <p-badge [value]="reaction.reactionType" class="mr-1 bg-pink-500 text-white"></p-badge>
          </ng-container>
          <button pButton type="button" icon="pi pi-thumbs-up" class="p-button-text p-0 text-xs" (click)="reactToMessage.emit({ messageId: msg.messageId, reaction: '👍' })"></button>
          <button pButton type="button" icon="pi pi-thumbs-down" class="p-button-text p-0 text-xs" (click)="reactToMessage.emit({ messageId: msg.messageId, reaction: '👎' })"></button>
          <button pButton type="button" icon="pi pi-trash" class="p-button-text p-0 text-xs text-red-500" (click)="deleteMessage.emit(msg.messageId)"></button>
        </div>
      </div>
    </div>
  </div>
</div>
